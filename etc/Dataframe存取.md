

```python
# -*- coding: utf-8 -*-
import tushare as ts
import datetime

Today = datetime.date.today().strftime('%Y-%m-%d')

df = ts.get_index()

# 以文本文件csv保存数据
df.to_csv('tmp.csv', columns=['open', 'high', 'low', 'close'])


```


```python
# 以二进制文件xlsx保存数据
df.to_excel('tmp.xlsx', columns=['open', 'high', 'low', 'close'])
```


```python
from Sqlite import DB_Sqlite3
# 写入sqlite3数据库中

# 连接数据库
db = DB_Sqlite3()
# 选取要写入的纵列, 列名称要与数据库表名一致
sql_df = df.loc[:10, ['open', 'high', 'low', 'close']]
sql_df
```




<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>open</th>
      <th>high</th>
      <th>low</th>
      <th>close</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3120.6963</td>
      <td>3125.2840</td>
      <td>3110.0817</td>
      <td>3118.0846</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3267.3276</td>
      <td>3272.1723</td>
      <td>3256.2203</td>
      <td>3264.6737</td>
    </tr>
    <tr>
      <th>2</th>
      <td>347.2136</td>
      <td>347.2136</td>
      <td>344.4838</td>
      <td>344.6643</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2718.7615</td>
      <td>2719.5762</td>
      <td>2706.1228</td>
      <td>2712.7597</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5559.2976</td>
      <td>5578.7082</td>
      <td>5543.6599</td>
      <td>5575.0965</td>
    </tr>
    <tr>
      <th>5</th>
      <td>7270.7268</td>
      <td>7280.5392</td>
      <td>7239.1397</td>
      <td>7248.1404</td>
    </tr>
    <tr>
      <th>6</th>
      <td>5744.4351</td>
      <td>5745.6978</td>
      <td>5733.1554</td>
      <td>5737.6042</td>
    </tr>
    <tr>
      <th>7</th>
      <td>159.6262</td>
      <td>159.6560</td>
      <td>159.5421</td>
      <td>159.5738</td>
    </tr>
    <tr>
      <th>8</th>
      <td>2299.7136</td>
      <td>2303.6854</td>
      <td>2288.3022</td>
      <td>2291.3842</td>
    </tr>
    <tr>
      <th>9</th>
      <td>2634.0751</td>
      <td>2638.0382</td>
      <td>2625.1682</td>
      <td>2631.9883</td>
    </tr>
    <tr>
      <th>10</th>
      <td>3342.3449</td>
      <td>3344.8584</td>
      <td>3324.9986</td>
      <td>3328.9827</td>
    </tr>
  </tbody>
</table>
</div>




```python
command = """
    	id integer primary key autoincrement unique not null,
    	open integer,
    	high integer,
    	low integer,
    	close integer
"""
db = DB_Sqlite3()

db.TB_C('stock', command)

for item in sql_df.T:
    # 转置后直接操作行,数据库\Dataframe数据要对应
    db.TB_I('stock', 'open, high, low, close', tuple(sql_df.T[item]))
print(db.TB_R('stock'))
#db.TB_D('stock')

del db


```

    [(1, 3120.6963, 3125.284, 3110.0817, 3118.0846), (2, 3267.3276, 3272.1723, 3256.2203, 3264.6737), (3, 347.2136, 347.2136, 344.4838, 344.6643), (4, 2718.7615, 2719.5762, 2706.1228, 2712.7597), (5, 5559.2976, 5578.7082, 5543.6599, 5575.0965), (6, 7270.7268, 7280.5392, 7239.1397, 7248.1404), (7, 5744.4351, 5745.6978, 5733.1554, 5737.6042), (8, 159.6262, 159.656, 159.5421, 159.5738), (9, 2299.7136, 2303.6854, 2288.3022, 2291.3842), (10, 2634.0751, 2638.0382, 2625.1682, 2631.9883), (11, 3342.3449, 3344.8584, 3324.9986, 3328.9827)]
    


```python
json = sql_df.to_json()
json
```




    '{"open":{"0":3120.6963,"1":3267.3276,"2":347.2136,"3":2718.7615,"4":5559.2976,"5":7270.7268,"6":5744.4351,"7":159.6262,"8":2299.7136,"9":2634.0751,"10":3342.3449},"high":{"0":3125.284,"1":3272.1723,"2":347.2136,"3":2719.5762,"4":5578.7082,"5":7280.5392,"6":5745.6978,"7":159.656,"8":2303.6854,"9":2638.0382,"10":3344.8584},"low":{"0":3110.0817,"1":3256.2203,"2":344.4838,"3":2706.1228,"4":5543.6599,"5":7239.1397,"6":5733.1554,"7":159.5421,"8":2288.3022,"9":2625.1682,"10":3324.9986},"close":{"0":3118.0846,"1":3264.6737,"2":344.6643,"3":2712.7597,"4":5575.0965,"5":7248.1404,"6":5737.6042,"7":159.5738,"8":2291.3842,"9":2631.9883,"10":3328.9827}}'




```python

```
